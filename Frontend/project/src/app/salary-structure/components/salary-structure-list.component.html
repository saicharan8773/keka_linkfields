<div class="dashboard-container">
  <app-sidebar></app-sidebar>

  <main class="main-content">
    <div class="employee-container">
      <!-- Header -->
      <div class="page-header">
        <div>
          <h1>Salary Structures</h1>
          <p class="subtitle">Manage your organization’s salary structures</p>
        </div>
      </div>

      <!-- Search and Add Button Row -->
      <div class="search-add-row">
        <div class="search-box">
          <input
            type="text"
            placeholder="Search salary structures…"
            [(ngModel)]="searchText"
            (input)="onSearch()"
          />
        </div>
        <button class="btn-add-gold" (click)="showAddSalaryStructureModal = true">
          <span class="plus-sign">+</span> Add Structure
        </button>
      </div>

      <!-- Table -->
      <div class="table-wrapper" *ngIf="salaryStructures.length > 0">
        <table class="employee-table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Basic</th>
              <th>HRA</th>
              <th>Other Allowances</th>
              <th>Deductions</th>
              <th>Total (Net)</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let structure of salaryStructures">
              <td data-label="Title">{{ structure.title }}</td>
              <td data-label="Basic">{{ structure.basic | currency:'INR' }}</td>
              <td data-label="HRA">{{ structure.hra | currency:'INR' }}</td>
              <td data-label="Other Allowances">{{ structure.otherAllowances | currency:'INR' }}</td>
              <td data-label="Deductions">{{ structure.deductions | currency:'INR' }}</td>
              <td data-label="Total (Net)">{{ calculateTotal(structure) | currency:'INR' }}</td>
              <td data-label="Actions" class="action-col">
                <button
                  class="icon-btn"
                  (click)="showDetailsModal(structure.id!)"
                  title="View"
                >
                  <i class="bi bi-eye-fill" style="font-size:18px"></i>
                </button>

                <button
                  class="icon-btn"
                  (click)="showEditModal(structure.id!)"
                  title="Edit"
                >
                 <i class="bi bi-pencil-square" style="font-size:18px"></i>
                </button>

                <button
                  class="icon-btn delete"
                  (click)="onDelete(structure.id)"
                  title="Delete"
                >
                  <i class="bi bi-trash-fill" style="font-size:18px; color: #c33;"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="salaryStructures.length === 0" class="empty-state">
        <p>No salary structures found.</p>
      </div>
    </div>

    <!-- Add Salary Structure Modal -->
    <div *ngIf="showAddSalaryStructureModal" class="modal-overlay">
      <div class="modal-card">
        <app-salary-structure-create
          (closeModal)="showAddSalaryStructureModal = false"
          (salaryStructureAdded)="onSalaryStructureAdded()"
        ></app-salary-structure-create>
      </div>
    </div>

    <!-- Edit Salary Structure Modal -->
    <div *ngIf="showEditSalaryStructureModal" class="modal-overlay">
      <div class="modal-card">
        <app-salary-structure-edit-modal
          [salaryStructureId]="selectedSalaryStructureId"
          (closeModal)="showEditSalaryStructureModal = false"
          (salaryStructureUpdated)="onSalaryStructureUpdated()"
        ></app-salary-structure-edit-modal>
      </div>
    </div>

    <!-- Details Salary Structure Modal -->
    <div *ngIf="showDetailsSalaryStructureModal" class="modal-overlay">
      <div class="modal-card">
        <app-salary-structure-details-modal
          [salaryStructureId]="selectedSalaryStructureId"
          (closeModal)="showDetailsSalaryStructureModal = false"
          (editSalaryStructure)="showEditModalFromDetails($event)"
        ></app-salary-structure-details-modal>
      </div>
    </div>
  </main>
</div>
