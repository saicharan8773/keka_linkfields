<div class="dashboard-container" [class.sidebar-closed]="!sidebarOpen">
  <app-sidebar (sidebarToggle)="onSidebarToggle($event)"></app-sidebar>
  <main class="main-content">
    <div class="dashboard-header">
      <h1>Welcome to the Dashboard</h1>
      <p>Here's an overview of your team and upcoming celebrations</p>
    </div>

    <!-- Top small cards: Time Today and Leave Balances -->
    <div class="top-cards">
      <section class="card time-card">
        <div class="time-header">
          <div>
            <h3>Time Today - {{ currentTime | date : "EEE, dd MMM yyyy" }}</h3>
          </div>
          <a class="view-all" href="#">View All</a>
        </div>

        <div class="time-body">
          <div class="current-time">
            <div class="time-large">
              {{ currentTime | date : "hh:mm" }}
              <span class="seconds">{{ currentTime | date : "ss" }}</span>
            </div>
            <div class="ampm">{{ currentTime | date : "a" }}</div>
          </div>
          <div class="time-actions">
            <button class="btn">Work From Home</button>
            <select class="btn small">
              <option>Other</option>
            </select>
          </div>
        </div>
      </section>

      <section class="card balances-card">
        <h3>Leave Balances</h3>
        <div class="balances-row">
          <div class="balance-item">
            <div class="circle">
              <div class="value">{{ leaveBalances?.sickLeave ?? 0 }}</div>
            </div>
            <div class="label">SICK LEAVE</div>
          </div>

          <div class="balance-item">
            <div class="circle">
              <div class="value">{{ leaveBalances?.lop ?? "‚àû" }}</div>
            </div>
            <div class="label">LOP</div>
          </div>

          <div class="balance-item">
            <div class="circle">
              <div class="value">{{ leaveBalances?.earnedLeave ?? 0 }}</div>
            </div>
            <div class="label">EARNED LEAVE</div>
          </div>
        </div>

        <div class="balances-links">
          <a [routerLink]="['/leave']" [queryParams]="{ action: 'apply' }">Request Leave</a>
          <a href="#">View All Balances</a>
        </div>
      </section>
    </div>

    <div class="dashboard-grid">

      <!-- On Leave Today -->
      <section class="card on-leave-card">
  <h2>Employees On Leave ({{ employeesOnLeave.length }})</h2>

  <div class="employees-container">
 <div class="leave-date-picker">
    <label for="leaveDate">Date:</label>
    <input
      id="leaveDate"
      type="date"
      [(ngModel)]="selectedLeaveDate"
      (change)="fetchEmployeesOnLeave(selectedLeaveDate)"
    />
  </div>
    <div class="employees-row">
      <div
        *ngFor="let emp of employeesOnLeave"
        class="employee-item professional hover-card"
      >
        <div
          class="avatar-circle"
          [title]="emp.displayName || (emp.firstName + ' ' + emp.lastName)"
        >
          {{ emp.firstName[0] }}{{ emp.lastName[0] }}
        </div>

        <div class="employee-info">
          <span class="employee-name">
            {{ emp.displayName || emp.firstName + ' ' + emp.lastName }}
          </span>
          <span class="employee-email">
            {{ emp.workEmail }}
          </span>
        </div>
    

      </div>
    </div>
       <div *ngIf="employeesOnLeave.length === 0" class="empty-state">
      <p>No employees on leave for this date</p>
    </div>
  </div>
</section>

      

      <!-- Birthdays & Anniversaries Tabs -->
      <section class="card celebrations-card">
        <div class="tabs-header">
          <div class="tab-buttons">
            <button class="tab-btn" [class.active]="activeTab === 'birthdays'" (click)="switchTab('birthdays')">
              üéÇ {{ birthdaysToday.length }} Birthday
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'anniversaries'" (click)="switchTab('anniversaries')">
              üéñÔ∏è {{ workAnniversariesToday.length }} Work Anniversary
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'joiners'" (click)="switchTab('joiners')">
              üë§ {{ newJoiners.length }} New joinee<span *ngIf="newJoiners.length !== 1">s</span>
            </button>
          </div>
        </div>

        <!-- Birthdays Tab -->
        <div id="birthdays" class="tab-content" [class.active]="activeTab === 'birthdays'">
          <div class="celebrations-section">
            <h3>Birthdays today</h3>
            <div class="celebrations-list">
              <div *ngIf="birthdaysToday.length === 0" class="empty-state">
                <p>No birthdays today</p>
              </div>
              <div *ngFor="let emp of birthdaysToday; let i = index" class="celebration-item">
                <div class="avatar" [style.background-color]="getAvatarColor(i)">
                  {{ getInitials(emp.name) }}
                </div>
                <div class="employee-info">
                  <span class="employee-name">{{ emp.name }}</span>
                  <a href="#" class="wish-btn">Wish</a>
                </div>
              </div>
            </div>

            <div class="upcoming-section">
              <h4>Upcoming Birthdays (Next 15 Days)</h4>
              <div class="upcoming-list">
                <div *ngIf="upcomingBirthdays.length === 0" class="empty-state">
                  <p>No upcoming birthdays in the next 15 days</p>
                </div>
                <div *ngFor="let emp of upcomingBirthdays; let i = index" class="upcoming-item">
                  <div class="avatar" [style.background-color]="getAvatarColor(i)">
                    {{ getInitials(emp.name) }}
                  </div>
                  <span class="employee-name">{{ emp.name }}</span>
                  <span class="date">{{
                    formatDate(emp.dateOfBirth || "")
                    }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Work Anniversaries Tab -->
        <div id="anniversaries" class="tab-content" [class.active]="activeTab === 'anniversaries'">
          <div class="celebrations-section">
            <h3>Work Anniversaries today</h3>
            <div class="celebrations-list">
              <div *ngIf="workAnniversariesToday.length === 0" class="empty-state">
                <p>No work anniversaries today</p>
              </div>
              <div *ngFor="let emp of workAnniversariesToday; let i = index" class="celebration-item">
                <div class="avatar" [style.background-color]="getAvatarColor(i)">
                  {{ getInitials(emp.name) }}
                </div>
                <div class="employee-info">
                  <div>
                    <span class="employee-name">{{ emp.name }}</span>
                    <div *ngIf="emp.anniversaryMessage" style="font-size: 0.85em; color: #666; margin-top: 2px;">
                      üéâ {{ emp.anniversaryMessage }}
                    </div>
                  </div>
                  <a href="#" class="wish-btn">Wish</a>
                </div>
              </div>
            </div>

            <div class="upcoming-section">
              <h4>Upcoming Work Anniversaries</h4>
              <div class="upcoming-list">
                <div *ngIf="upcomingWorkAnniversaries.length === 0" class="empty-state">
                  <p>No upcoming work anniversaries</p>
                </div>
                <div *ngFor="let emp of upcomingWorkAnniversaries; let i = index" class="upcoming-item">
                  <div class="avatar" [style.background-color]="getAvatarColor(i)">
                    {{ getInitials(emp.name) }}
                  </div>
                  <span class="employee-name">{{ emp.name }}</span>
                  <span class="date">{{
                    formatDate(emp.workAnniversaryDate || "")
                    }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- New Joiners Tab -->
        <div id="joiners" class="tab-content" [class.active]="activeTab === 'joiners'">
          <div class="celebrations-section">
            <h3>New joiners (Last 30 Days)</h3>
            <div class="celebrations-list">
              <div *ngIf="newJoiners.length === 0" class="empty-state">
                <p>No new joiners in the last 30 days</p>
              </div>
              <div *ngFor="let emp of newJoiners; let i = index" class="celebration-item">
                <div class="avatar" [style.background-color]="getAvatarColor(i)">
                  {{ getInitials(emp.name) }}
                </div>
                <div class="employee-info">
                  <div>
                    <span class="employee-name">{{ emp.name }}</span>
                    <div *ngIf="emp.joinDate" style="font-size: 0.85em; color: #666; margin-top: 2px;">
                      üìÖ Joined on {{ formatDate(emp.joinDate) }}
                    </div>
                  </div>
                  <a href="#" class="wish-btn">Welcome</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>
</div>

<script>
  function switchTab(tabName) {
    // Hide all tabs
    const tabs = document.querySelectorAll(".tab-content");
    tabs.forEach((tab) => tab.classList.remove("active"));

    // Deactivate all buttons
    const buttons = document.querySelectorAll(".tab-btn");
    buttons.forEach((btn) => btn.classList.remove("active"));

    // Show selected tab
    const selectedTab = document.getElementById(tabName);
    if (selectedTab) {
      selectedTab.classList.add("active");
    }

    // Activate clicked button
    event.target.classList.add("active");
  }
</script>