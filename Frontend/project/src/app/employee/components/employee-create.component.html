<div class="modal-overlay">
  <div class="modal-card">
    <!-- FIXED HEADER -->
    <div class="modal-header-fixed">
      <div class="modal-header">
        <h2>Add New Employee</h2>
        <button class="close-btn" (click)="onCancel()">Ã—</button>
      </div>
      <p class="subtitle">Fill in the details to add a new employee.</p>
    </div>

    <!-- SCROLLABLE CONTENT -->
    <div class="modal-body-scrollable">
      <form (ngSubmit)="onSubmit()" #f="ngForm">
        <h3 class="section-title">Basic Information</h3>

        <div class="row">
          <div class="col">
            <label>Employee Code *</label>
            <input type="text" name="employeeCode" [(ngModel)]="employee.employeeCode" required #ec="ngModel" />
            <div class="error" *ngIf="ec.invalid && ec.touched">
              Employee code is required
            </div>
          </div>

          <div class="col">
            <label>Display Name</label>
            <input type="text" name="displayName" [(ngModel)]="employee.displayName" />
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label>First Name *</label>
            <input type="text" name="firstName" [(ngModel)]="employee.firstName" required #fn="ngModel" />
            <div class="error" *ngIf="fn.invalid && fn.touched">
              First name is required
            </div>
          </div>

          <div class="col">
            <label>Last Name *</label>
            <input type="text" name="lastName" [(ngModel)]="employee.lastName" required #ln="ngModel" />
            <div class="error" *ngIf="ln.invalid && ln.touched">
              Last name is required
            </div>
          </div>
        </div>

        <h3 class="section-title">Contact Information</h3>

        <div class="row">
          <div class="col">
            <label>Work Email *</label>
            <input type="email" name="workEmail" [(ngModel)]="employee.workEmail" required email #we="ngModel" />
            <div class="error" *ngIf="we.invalid && we.touched">
              Invalid email address
            </div>
          </div>

          <div class="col">
            <label>Mobile Number</label>
            <input type="text" name="mobileNumber" [(ngModel)]="employee.mobileNumber" />
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label>Date of Birth</label>
            <input type="date" name="dateOfBirth" [(ngModel)]="employee.dateOfBirth" />
          </div>

          <div class="col">
            <label>Gender</label>
            <input type="text" name="gender" [(ngModel)]="employee.gender" />
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label>Nationality</label>
            <input type="text" name="nationality" [(ngModel)]="employee.nationality" />
          </div>

          <div class="col">
            <label>Joining Date *</label>
            <input type="date" name="joiningDate" [(ngModel)]="employee.joiningDate" required #jd="ngModel" />
            <div class="error" *ngIf="jd.invalid && jd.touched">
              Joining date is required
            </div>
          </div>
        </div>

        <h3 class="section-title">Organization Details</h3>

        <div class="row">
          <div class="col">
            <label>Department</label>
            <select name="departmentId" [(ngModel)]="employee.departmentId" (ngModelChange)="onDepartmentChange()">
              <option value="">Select Department</option>
              <option *ngFor="let dep of departments" [value]="dep.id">
                {{ dep.name }}
              </option>
            </select>
          </div>

          <div class="col">
            <label>Designation</label>
            <select name="designationId" [(ngModel)]="employee.designationId" [disabled]="!employee.departmentId">
              <option value="">
                {{
                employee.departmentId
                ? "Select Designation"
                : "Select Department First"
                }}
              </option>
              <option *ngFor="let d of designations" [value]="d.id">
                {{ d.title }}
              </option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label>Manager</label>
            <select name="managerId" [(ngModel)]="employee.managerId">
              <option value="">Select Manager</option>
              <option *ngFor="let m of users" [value]="m.id">
                {{ m.fullName }}
              </option>
            </select>
          </div>

          <div class="col">
            <label>Location</label>
            <select name="locationId" [(ngModel)]="employee.locationId">
              <option value="">Select Location</option>
              <option *ngFor="let loc of locations" [value]="loc.id">
                {{ loc.city }}, {{ loc.country }}
              </option>
            </select>
          </div>
        </div>
        <!-- 
        <h3 class="section-title">Employment Info</h3> -->

        <div class="row">
          <div class="col">
            <label>Role *</label>
            <input type="text" name="role" [(ngModel)]="employee.role" required #role="ngModel" />
            <div class="error" *ngIf="role.invalid && role.touched">Role is required</div>
          </div>
          <div class="col">
            <label>Employment Type</label>
            <input type="text" name="employmentType" [(ngModel)]="employee.employmentType" />
          </div>

        </div>

        <div class="row">
          <div class="col">
            <label>Time Type</label>
            <input type="text" name="timeType" [(ngModel)]="employee.timeType" />
          </div>
          <div class="col">
            <label>Salary Structure</label>
            <select name="salaryStructureId" [(ngModel)]="employee.salaryStructureId">
              <option value="">Select Salary</option>
              <option *ngFor="let s of salaries" [value]="s.id">
                {{ s.title }}
              </option>
            </select>
          </div>
        </div>
      </form>
    </div>

    <!-- FIXED FOOTER -->
    <div class="modal-footer-fixed">
      <button type="button" class="btn cancel" (click)="onCancel()">
        Cancel
      </button>
      <button type="submit" class="btn primary" [disabled]="f.invalid || isLoading" (click)="onSubmit()">
        {{ isLoading ? "Creating..." : "Create Employee" }}
      </button>
    </div>
  </div>
</div>