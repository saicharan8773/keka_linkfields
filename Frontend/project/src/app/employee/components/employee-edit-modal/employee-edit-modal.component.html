<div class="modal-header">
  <h2>Edit Employee</h2>
  <button class="close-btn" (click)="onCancel()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>
</div>

<div class="modal-body">
  <div *ngIf="isLoading" class="loading">Loading employee details...</div>

  <div *ngIf="!isLoading && employee" class="form-card">
    <form (ngSubmit)="onSubmit()" class="employee-form">
      <h3 class="section-title">Primary Details</h3>

      <div class="form-row">
        <div class="form-group">
          <label>Employee Code *</label>
          <input type="text" [(ngModel)]="employee.employeeCode" name="employeeCode" required class="form-control" />
        </div>

        <div class="form-group">
          <label>First Name *</label>
          <input type="text" [(ngModel)]="employee.firstName" name="firstName" required class="form-control" />
        </div>

        <div class="form-group">
          <label>Last Name *</label>
          <input type="text" [(ngModel)]="employee.lastName" name="lastName" required class="form-control" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Display Name</label>
          <input type="text" [(ngModel)]="employee.displayName" name="displayName" class="form-control" />
        </div>

        <div class="form-group">
          <label>Date of Birth</label>
          <input type="date" [(ngModel)]="employee.dateOfBirth" name="dateOfBirth" class="form-control" />
        </div>

        <div class="form-group">
          <label>Gender</label>
          <input type="text" [(ngModel)]="employee.gender" name="gender" class="form-control" />
        </div>
      </div>

      <h3 class="section-title">Contact</h3>

      <div class="form-row">
        <div class="form-group">
          <label>Work Email *</label>
          <input type="email" [(ngModel)]="employee.workEmail" name="workEmail" required class="form-control" />
        </div>

        <div class="form-group">
          <label>Mobile Number</label>
          <input type="text" [(ngModel)]="employee.mobileNumber" name="mobileNumber" class="form-control" />
        </div>

        <div class="form-group">
          <label>Nationality</label>
          <input type="text" [(ngModel)]="employee.nationality" name="nationality" class="form-control" />
        </div>
      </div>

      <h3 class="section-title">Organization</h3>

      <div class="form-row">
        <div class="form-group">
          <label>Department</label>
          <select [(ngModel)]="employee.departmentId" name="departmentId" (ngModelChange)="onDepartmentChange()"
            class="form-control">
            <option value="">Select Department</option>
            <option *ngFor="let d of departments" [value]="d.id">
              {{ d.name }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Designation</label>
          <select [(ngModel)]="employee.designationId" name="designationId" [disabled]="!employee.departmentId"
            class="form-control">
            <option value="">{{ employee.departmentId ? 'Select Designation' : 'Select Department First' }}</option>
            <option *ngFor="let d of designations" [value]="d.id">
              {{ d.title }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Manager</label>
          <select [(ngModel)]="employee.managerId" name="managerId" class="form-control">
            <option value="">-- None --</option>
            <option *ngFor="let m of managers" [value]="m.id">
              {{ m.displayName }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Location</label>
          <select [(ngModel)]="employee.locationId" name="locationId" class="form-control">
            <option *ngFor="let l of locations" [value]="l.id">
              {{ l.name }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Employment Type *</label>
          <input type="text" [(ngModel)]="employee.employmentType" name="employmentType" class="form-control"
            required />
        </div>

        <div class="form-group">
          <label>Time Type</label>
          <input type="text" [(ngModel)]="employee.timeType" name="timeType" class="form-control" />
        </div>
      </div>

      <div *ngIf="errorMessage" class="alert alert-error">
        {{ errorMessage }}
      </div>
    </form>
  </div>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-secondary" (click)="onCancel()">
    Cancel
  </button>
  <button type="submit" class="btn btn-primary" [disabled]="isLoading" (click)="onSubmit()">
    {{ isLoading ? "Updating..." : "Update Employee" }}
  </button>
</div>